class MemoryGame{constructor(){this.local=window.localStorage,this.arr=["a","b","c","d","e","f","g","j","k","l"],this.shuffleCards=this.getShuffledArr(this.arr.concat(this.arr)),this.documentFragment=document.createDocumentFragment(),this.gridContainer=document.getElementById("grid-container"),this.message=document.getElementById("message"),this.notice=document.getElementById("notice"),this.statistics=document.getElementById("statistics"),this.timers=document.getElementById("timers"),this.clicks=document.getElementById("clicks"),this.minutes=document.getElementById("minutes"),this.seconds=document.getElementById("seconds"),this.spiner=document.getElementById("spn"),this.gameId="peaceonearth",this.card={timer:0,data:null,clickedCard:null,clicks:0,cards:0}}getShuffledArr(t){const e=t.slice();for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}createElements(t,e,s){const i=document.createElement(t);return i.className=e,i.innerHTML=s,i}timer(){let t=0;function e(t){return t>9?String(t):"0"+t}this.card.timer=setInterval((()=>{this.seconds.innerHTML=e(++t%60),this.minutes.innerHTML=e(parseInt(t/60,10))}),1e3)}getData(){const t=[];for(let e=0;e<this.local.length;e++){const s=this.local.key(e);s.includes("time-"+this.gameId)&&t.push(this.local.getItem(s))}return t.sort(((t,e)=>t.localeCompare(e))),t}handleClick(t){const e=t.target;if(e.classList.contains("korta")){if(this.card.cards||(this.card.clickedCard=t.target),2===this.card.cards)return!1;++this.card.cards;const s=Math.round(Math.random())>=.5?"pasukti":"pasukti1";if(e.className+=" "+s,2===this.card.cards)if(this.card.clicks+=1,this.clicks.innerHTML=this.card.clicks,this.gridContainer.style.pointerEvents="none",this.card.clickedCard.firstChild.className===e.firstChild.className)setTimeout((()=>{e.classList.add("blur"),this.card.clickedCard.classList.add("blur"),this.card.cards=0,this.gridContainer.style.pointerEvents="auto",this.gridContainer.getElementsByClassName("blur").length===this.shuffleCards.length&&(clearInterval(this.card.timer),this.message.innerHTML=`<h2>Your time: ${this.timers.textContent}</h2>`,this.local.setItem(`time-${this.gameId}${this.local.length}`,this.timers.textContent),this.card.data=this.getData(),this.showData(),this.gridContainer.innerHTML="",this.button("Play again"),this.message.style.display="block",this.card.clicks=0)}),300);else{let t=setTimeout((()=>{clearTimeout(t),t=0,e.classList.remove(s),this.card.clickedCard.className="korta",this.card.cards=0,this.gridContainer.style.pointerEvents="auto"}),900)}}}button(t){this.statistics.classList.add("hidden");const e=this.createElements("button","btn",t);e.onclick=()=>{this.start(),this.message.style.display="none",this.statistics.classList.remove("hidden")},this.message.appendChild(e)}showData(){this.card.data.length&&(this.message.innerHTML+="<h3>Best score: "+this.card.data.shift()+"</h3>"),this.card.data.length>0&&(this.message.innerHTML+="<h3>Other scores: "+this.card.data.join(", ")+"</h3>")}start(){this.local.setItem("visitor-"+this.gameId,"1"),this.shuffleCards=this.getShuffledArr(this.arr.concat(this.arr)),this.shuffleCards.forEach((t=>{const e=this.createElements("DIV","wrpko",""),s=this.createElements("DIV","korta",""),i=this.createElements("DIV","galas "+t,""),a=this.createElements("DIV","priekis","");e.appendChild(s).appendChild(i),s.appendChild(a),this.documentFragment.appendChild(e)})),this.gridContainer.appendChild(this.documentFragment),this.timer(),this.minutes.innerHTML=this.seconds.innerHTML="00",this.clicks.innerHTML=this.card.clicks}init(){this.card.data=this.getData(),this.showData(),this.button("Start")}}document.addEventListener("DOMContentLoaded",(()=>{const t=new MemoryGame;!function(...e){const s=[];let i=0;function a(a){let n=new Image;n.onload=function(){i++,i===e.length&&(t.spiner.className="hidden",t.init())},n.src=a,s.push(n)}for(let t=0;t<e.length;t++)a(e[t])}("img/01.svg","img/02.svg","img/03.svg","img/04.svg","img/05.svg","img/06.svg","img/07.svg","img/08.svg","img/09.svg","img/10.svg"),document.addEventListener("click",(e=>{t.handleClick(e)}))}));
